DROP TABLE film_showroom;
DROP TABLE showroom_network;
DROP TYPE nested_film_table;
DROP TYPE film_type;



---------1-es feladat---------

a. Film objektum létrehozása name, production_year, director, price attribútumokkal.
CREATE TYPE film_type AS OBJECT (
  name VARCHAR2(255),
  production_year NUMBER,
  director VARCHAR2(255),
  price NUMBER
);




b. Film_showroom tábla létrehozása.
CREATE TABLE film_showroom (
  film_id NUMBER GENERATED ALWAYS AS IDENTITY,
  film film_type
);




c. Adatok hozzáadása.
BEGIN

INSERT INTO film_showroom (film) VALUES (
  film_type('The Shawshank Redemption', 1994, 'Frank Darabont', 1100)
);

INSERT INTO film_showroom (film) VALUES (
  film_type('The Godfather', 1972, 'Francis Ford Coppola', 900)
);

INSERT INTO film_showroom (film) VALUES (
  film_type('The Dark Knight', 2008, 'Christopher Nolan', 1300)
);

INSERT INTO film_showroom (film) VALUES (
  film_type('Pulp Fiction', 1994, 'Quentin Tarantino', 1000)
);

INSERT INTO film_showroom (film) VALUES (
  film_type('Forrest Gump', 1994, 'Robert Zemeckis', 950)
);

END;




d. Minden film objektum nevének majd árának lekérdezése a film_showroom táblából.
SELECT f.film.name AS film_name FROM film_showroom f;
SELECT f.film.price AS film_price FROM film_showroom f;




e. Minden film ára legyen 900, ami 5 évnél idősebb.
UPDATE film_showroom f SET f.film.price = 900 WHERE f.film.production_year < 2019;










---------2-es feladat---------



a. A nested_film_table beágyazott táblatípus létrehozása
CREATE TYPE nested_film_table IS TABLE OF film_type;




b. showroom_network tábla létrehozása az id, cinema, és a film_table adattagokkal.
CREATE TABLE showroom_network (
  id NUMBER,
  cinema VARCHAR2(255),
  film_table nested_film_table)
  NESTED TABLE film_table STORE AS nested_film_tables




c. 2 film felvétele a Miskolci Cinema Citybe
INSERT INTO showroom_network (cinema) VALUES ('Cinema City Miskolc');


UPDATE showroom_network
SET film_table = nested_film_table(
  film_type('Schindlers List', 1993, 'Steven Spielberg', 1800),
  film_type('Inglourious Basterds', 2009, 'Quentin Tarantino', 2200)
)
WHERE cinema = 'Cinema City Miskolc';




d. 1 film felvétele a Debreceni Cinema Citybe
INSERT INTO showroom_network (cinema) VALUES ('Cinema City Debrecen');


UPDATE showroom_network
SET film_table = nested_film_table(
  film_type('The Lord of the Rings: The Return of the King', 2003, 'Peter Jackson', 1700)
)
WHERE cinema = 'Cinema City Debrecen';




e. A Miskolci Cinema Cityben található filmek lekérdezése
SELECT film_table FROM showroom_network WHERE cinema = 'Cinema City Miskolc';




f. Minden adat lekérdezése
SELECT id, cinema, film_table FROM showroom_network;
SELECT * FROM showroom_network;




g. Beágyazott tábla adatainak lekérése
SELECT id, cinema, f.* FROM showroom_network s, TABLE(s.film_table) f;







